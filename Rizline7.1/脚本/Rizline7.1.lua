require("point")

path= getSdPath().."/rizline.txt"
if fileExist(path)==false then--写文件，文件不存在则创建初始化文件
	writeFile(path,"{\"server\":\"1\",\"target\":\"0\",\"get\":\"0\"}" ,false)
end
uisetfile=readFile(path)
--打开界面并加载配置
function onLoadEvent(handle)
	setUIConfig(handle,uisetfile)
end
action,arr = showUI("in.ui",800,600,onLoadEvent);



function main()
	--保存配置
    
	txt = "\"server\":\""..arr["server"].."\",".."\"target\":\""..arr["target"].."\",".."\"get\":\""..get.."\""
	writeFile(path,"{"..txt.."}" ,false)
    if math.tointeger(get)>math.tointeger(arr["target"]) then
    	exitScript()
        console.println(3,"结束")
    end
	while cmpColorEx(接下来,0.9)==0 do
        touchDown(1,638,364)
        touchUp(1)
		sleep(300)
        if cmpColorEx(溢出,0.9)==1 then
        	exitScript()
        end
		if cmpColorEx(确定,0.9)==1 then
			touchDown(1,752,252)
            touchUp(1)
			sleep(200)
		end
	end
	
    while cmpColorEx(暂停,0.9)==0 do
    	touchDown(1,260,379)
        touchMoveEx(1,494,362,10)
        touchUp(1)
    end
    sleep(1500)
	touchDown(1,494,362)
    touchMoveEx(1,39,344,100)
    touchUp(1)
	--while cmpColorEx(暂停,0.95)==1 do
    --	sleep(1)
    --end
	sleep(3000)
	--playsong()
    playsong1()
    --playsong2()
    toast("judging acc")
    judgeacc()
    writeLog(get)
	sleep(5000)
end

function playsong1()
	sleep(8240)
	toast("start")
	touchDown(1,638,364)
	touchUp(1)
	sleep(3200)
	touchDown(1,638,364)
    touchUp(1)
	sleep(2850)
	touchDown(1,638,364)
    touchUp(1)
	sleep(1560)
	touchDown(1,638,364)
    touchUp(1)
	sleep(1570)
	touchDown(1,638,364)
    touchUp(1)
	sleep(1580)
	touchDown(1,638,364)
    touchUp(1)
	sleep(1570)
	touchDown(1,638,364)
    touchUp(1)
	sleep(1580)
	touchDown(1,638,364)
    touchUp(1)
	sleep(1670)
	touchDown(1,638,364)
    touchUp(1)
	sleep(1650)
	touchDown(1,638,364)
	sleep(26810)
	touchUp(1)
	sleep(310)
	---进入高潮段
	touchDown(1,638,364)
	sleep(1600)
	touchUp(1)
	touchDown(1,638,364)
	sleep(1570)
	touchUp(1)
	touchDown(1,638,364)
	sleep(1600)
	touchUp(1)
	touchDown(1,638,364)
	sleep(1600)
	touchUp(1)
	touchDown(1,638,364)
	sleep(1580)
	touchUp(1)
	touchDown(1,638,364)
	sleep(1590)
	touchUp(1)
	touchDown(1,638,364)
	sleep(1600)
	touchUp(1)
	touchDown(1,638,364)
	sleep(2570)
	touchUp(1)
	---riztime phase 2
	sleep(618)
	toast("phase 2")
	touchDown(1,638,364)
	sleep(1600)
	touchUp(1)
	touchDown(1,638,364)
	sleep(1590)
	touchUp(1)
	touchDown(1,638,364)
	sleep(1600)
	touchUp(1)
	touchDown(1,638,364)
	sleep(1600)
	touchUp(1)
	touchDown(1,638,364)
	sleep(1580)
	touchUp(1)
	touchDown(1,638,364)
	sleep(14560)
	touchUp(1)
	toast("hold stopped")
	sleep(1400)
	touchDown(1,638,364)
    touchUp(1)
	sleep(810)
	touchDown(1,638,364)
    touchUp(1)
	sleep(810)
	touchDown(1,638,364)
    touchUp(1)
	sleep(1600)
	touchDown(1,638,364)
    touchUp(1)
	sleep(810)
	touchDown(1,638,364)
    touchUp(1)
	sleep(810)
	touchDown(1,638,364)
    touchUp(1)
	sleep(1600)
	touchDown(1,500,500)
	touchDown(2,600,600)
	touchUp(1)
	touchUp(2)
	sleep(1600)
	toast("two 1")
	touchDown(1,500,500)
	touchDown(2,600,600)
	touchUp(1)
	touchUp(2)
	sleep(1620)
	toast("two 2")
	touchDown(1,500,500)
	touchDown(2,600,600)
	sleep(3200)
	touchUp(1)
	touchUp(2)
end

function playsong2()
	sleep(8650)
	toast("start")
	touchDown(1,638,364)
	touchUp(1)
	sleep(3265)
	touchDown(1,638,364)
    touchUp(1)
	sleep(2990)
	touchDown(1,638,364)
    touchUp(1)
	sleep(1665)
	touchDown(1,638,364)
    touchUp(1)
	sleep(1665)
	touchDown(1,638,364)
    touchUp(1)
	sleep(1665)
	touchDown(1,638,364)
    touchUp(1)
	sleep(1660)
	touchDown(1,638,364)
    touchUp(1)
	sleep(1655)
	touchDown(1,638,364)
    touchUp(1)
	sleep(1655)
	touchDown(1,638,364)
    touchUp(1)
	sleep(1655)
	touchDown(1,638,364)
	sleep(27010)
	touchUp(1)
	sleep(310)
	---进入高潮段
    toast("hello world",0,0,12)
	touchDown(1,638,364)
	sleep(1630)
	touchUp(1)
	touchDown(1,638,364)
	sleep(1650)
	touchUp(1)
	touchDown(1,638,364)
	sleep(1600)
	touchUp(1)
	touchDown(1,638,364)
	sleep(1600)
	touchUp(1)
	touchDown(1,638,364)
	sleep(1580)
	touchUp(1)
	touchDown(1,638,364)
	sleep(1590)
	touchUp(1)
	touchDown(1,638,364)
	sleep(1600)
	touchUp(1)
	touchDown(1,638,364)
	sleep(2570)
	touchUp(1)
	---riztime phase 2
	sleep(618)
	toast("phase 2")
	touchDown(1,638,364)
	sleep(1600)
	touchUp(1)
	touchDown(1,638,364)
	sleep(1590)
	touchUp(1)
	touchDown(1,638,364)
	sleep(1600)
	touchUp(1)
	touchDown(1,638,364)
	sleep(1600)
	touchUp(1)
	touchDown(1,638,364)
	sleep(1580)
	touchUp(1)
	touchDown(1,638,364)
	sleep(14560)
	touchUp(1)
	toast("hold stopped")
	sleep(1400)
	touchDown(1,638,364)
    touchUp(1)
	sleep(810)
	touchDown(1,638,364)
    touchUp(1)
	sleep(810)
	touchDown(1,638,364)
    touchUp(1)
	sleep(1600)
	touchDown(1,638,364)
    touchUp(1)
	sleep(810)
	touchDown(1,638,364)
    touchUp(1)
	sleep(810)
	touchDown(1,638,364)
    touchUp(1)
	sleep(1600)
	touchDown(1,500,500)
	touchDown(2,600,600)
	touchUp(1)
	touchUp(2)
	sleep(1600)
	toast("two 1")
	touchDown(1,500,500)
	touchDown(2,600,600)
	touchUp(1)
	touchUp(2)
	sleep(1620)
	toast("two 2")
	touchDown(1,500,500)
	touchDown(2,600,600)
	sleep(3200)
	touchUp(1)
	touchUp(2)
end
function playsong()
	sleep(8660)
	toast("start")
	touchDown(1,638,364)
    touchUp(1)
	sleep(3415)
	touchDown(1,638,364)
    toast("hello world",0,0,12)
    touchUp(1)
	sleep(2920)
	touchDown(1,638,364)
    touchUp(1)
	sleep(1650)
	touchDown(1,638,364)
    touchUp(1)
	sleep(1685)
	touchDown(1,638,364)
	sleep(1685)
	touchDown(1,638,364)
	sleep(1685)
	touchDown(1,638,364)
	sleep(1690)
	touchDown(1,638,364)
	sleep(1675)
	touchDown(1,638,364)
	sleep(1640)
	touchDown(1,638,364)
	sleep(26880)
	touchUp(1)
	sleep(340)
	---进入高潮段
	touchDown(1,638,364)
	sleep(1680)
	touchUp(1)
	touchDown(1,638,364)
	sleep(1695)
	touchUp(1)
	touchDown(1,638,364)
	sleep(1695)
	touchUp(1)
	touchDown(1,638,364)
	sleep(1695)
	touchUp(1)
	touchDown(1,638,364)
	sleep(1695)
	touchUp(1)
	touchDown(1,638,364)
	sleep(1695)
	touchUp(1)
	touchDown(1,638,364)
	sleep(1695)
	touchUp(1)
	touchDown(1,638,364)
	sleep(2570)
	touchUp(1)
	---riztime phase 2
	sleep(658)
	toast("phase 2")
	touchDown(1,638,364)
	sleep(1695)
	touchUp(1)
	touchDown(1,638,364)
	sleep(1695)
	touchUp(1)
	touchDown(1,638,364)
	sleep(1695)
	touchUp(1)
	touchDown(1,638,364)
	sleep(1695)
	touchUp(1)
	touchDown(1,638,364)
	sleep(1695)
	touchUp(1)
	touchDown(1,638,364)
	sleep(14560)
	touchUp(1)
	toast("hold stopped")
	sleep(1400)
	touchDown(1,638,364)
	sleep(810)
	touchDown(1,638,364)
	sleep(810)
	touchDown(1,638,364)
	sleep(1600)
	touchDown(1,638,364)
	sleep(810)
	touchDown(1,638,364)
	sleep(810)
	touchDown(1,638,364)
	sleep(1600)
	touchDown(1,500,500)
	touchDown(2,600,600)
	touchUp(1)
	touchUp(2)
	sleep(1600)
	toast("two 1")
	touchDown(1,500,500)
	touchDown(2,600,600)
	touchUp(1)
	touchUp(2)
	sleep(1620)
	toast("two 2")
	touchDown(1,500,500)
	touchDown(2,600,600)
	sleep(3200)
	touchUp(1)
	touchUp(2)
end

function judgeacc()
	if cmpColorEx(acc120,0.9)==1 then
    	get=get+21
    elseif cmpColorEx(acc110,0.9)==1 then
        get=get+18
	elseif cmpColorEx(acc100,0.9)==1 then
        get=get+15
	elseif cmpColorEx(acc90,0.9)==1 then
    	get=get+12
    elseif cmpColorEx(acc80,0.9)==1 then
        get=get+9
    end
    print(get)
end
get=math.tointeger(arr["get"])
sleep(200)
if arr["server"]=="0" then
 runApp("com.PigeonGames.Rizline")
else
 runApp("com.leiting.ldgj")
end
setControlBarPosNew(0,1)
sleep(500)

while true do
 main()
--	local tid=beginThread(main)
--	while true do
--		sleep(100)
--		if cmpColorEx(失败,0.9)==1 or cmpColorEx(失败2,0.92)==1 then
--			if tid ~= nil then
--				print("failed")
--				stopThread(tid)
--				tid = nil
--				break
--			end
--		end
--	end
end

